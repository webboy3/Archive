!function(window){if(void 0===window)throw new Error("Geetest requires browser environment");const document=window.document,Math=window.Math,head=document.getElementsByTagName("head")[0];function _Object(obj){this._obj=obj}function Config(config){const self=this;new _Object(config)._each((key,value)=>{self[key]=value})}_Object.prototype={_each(process){const _obj=this._obj;for(const k in _obj)_obj.hasOwnProperty(k)&&process(k,_obj[k]);return this}},Config.prototype={api_server:"api.geetest.com",protocol:"http://",typePath:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config(){const self=this;return isString(self.type)?self.fallback_config[self.type]:self.new_captcha?self.fallback_config.fullpage:self.fallback_config.slide},_extend(obj){const self=this;new _Object(obj)._each((key,value)=>{self[key]=value})}};const isNumber=function(value){return"number"==typeof value};var isString=function(value){return"string"==typeof value};const isBoolean=function(value){return"boolean"==typeof value},isObject=function(value){return"object"==typeof value&&null!==value},isFunction=function(value){return"function"==typeof value},MOBILE=/Mobi/i.test(navigator.userAgent),pt=MOBILE?3:0,callbacks={},status={},nowDate=function(){const date=new Date,year=date.getFullYear();let month=date.getMonth()+1,day=date.getDate(),hours=date.getHours(),minutes=date.getMinutes(),seconds=date.getSeconds();month>=1&&month<=9&&(month=`0`),day>=0&&day<=9&&(day=`0`),hours>=0&&hours<=9&&(hours=`0`),minutes>=0&&minutes<=9&&(minutes=`0`),seconds>=0&&seconds<=9&&(seconds=`0`);const currentdate=`-- ::`;return currentdate},random=function(){return parseInt(1e4*Math.random())+(new Date).valueOf()},loadScript=function(url,cb){const script=document.createElement("script");script.charset="UTF-8",script.async=!0,/static\.geetest\.com/g.test(url)&&(script.crossOrigin="anonymous"),script.onerror=function(){cb(!0)};let loaded=!1;script.onload=script.onreadystatechange=function(){loaded||script.readyState&&"loaded"!==script.readyState&&"complete"!==script.readyState||(loaded=!0,setTimeout(()=>{cb(!1)},0))},script.src=url,head.appendChild(script)},normalizeDomain=function(domain){return domain.replace(/^https?:\/\/|\/$/g,"")},normalizePath=function(path){return 0!==(path=path.replace(/\/+/g,"/")).indexOf("/")&&(path=`/`),path},normalizeQuery=function(query){if(!query)return"";let q="?";return new _Object(query)._each((key,value)=>{(isString(value)||isNumber(value)||isBoolean(value))&&(q=`${q+encodeURIComponent(key)}=${encodeURIComponent(value)}&`)}),"?"===q&&(q=""),q.replace(/&$/,"")},makeURL=function(protocol,domain,path,query){domain=normalizeDomain(domain);let url=normalizePath(path)+normalizeQuery(query);return domain&&(url=protocol+domain+url),url},load=function(config,send,protocol,domains,path,query,cb){var tryRequest=function(at){const url=makeURL(protocol,domains[at],path,query);loadScript(url,err=>{if(err)if(at>=domains.length-1){if(cb(!0),send){config.error_code=508;const url=protocol+domains[at]+path;reportError(config,url)}}else tryRequest(at+1);else cb(!1)})};tryRequest(0)},jsonp=function(domains,path,config,callback){if(isObject(config.getLib))return config._extend(config.getLib),void callback(config);if(config.offline)return void callback(config._get_fallback_config());const cb=`geetest_${random()}`;window[cb]=function(data){"success"==data.status?callback(data.data):data.status?callback(config._get_fallback_config()):callback(data),window[cb]=void 0;try{delete window[cb]}catch(e){}},load(config,!0,config.protocol,domains,path,{gt:config.gt,callback:cb},err=>{err&&callback(config._get_fallback_config())})};var reportError=function(config,url){load(config,!1,config.protocol,["monitor.geetest.com"],"/monitor/send",{time:nowDate(),captcha_id:config.gt,challenge:config.challenge,pt:pt,exception_url:url,error_code:config.error_code},err=>{})};const throwError=function(errorType,config){const errors={networkError:"网络错误",gtTypeError:"gt字段不是字符串类型"};if("function"!=typeof config.onError)throw new Error(errors[errorType]);config.onError(errors[errorType])},detect=function(){return window.Geetest||document.getElementById("gt_lib")};detect()&&(status.slide="loaded"),window.initGeetest=function(userConfig,callback){const config=new Config(userConfig);userConfig.https?config.protocol="https://":userConfig.protocol||(config.protocol=`${window.location.protocol}//`),"050cffef4ae57b5d5e529fea9540b0d1"!==userConfig.gt&&"3bd38408ae4af923ed36e13819b14d42"!==userConfig.gt||(config.apiserver="yumchina.geetest.com/",config.api_server="yumchina.geetest.com"),userConfig.gt&&(window.GeeGT=userConfig.gt),userConfig.challenge&&(window.GeeChallenge=userConfig.challenge),isObject(userConfig.getType)&&config._extend(userConfig.getType),jsonp([config.api_server||config.apiserver],config.typePath,config,newConfig=>{const type=newConfig.type,init=function(){config._extend(newConfig),callback(new window.Geetest(config))};callbacks[type]=callbacks[type]||[];const s=status[type]||"init";"init"===s?(status[type]="loading",callbacks[type].push(init),load(config,!0,config.protocol,newConfig.static_servers||newConfig.domains,newConfig[type]||newConfig.path,null,err=>{if(err)status[type]="fail",throwError("networkError",config);else{status[type]="loaded";const cbs=callbacks[type];for(let i=0,len=cbs.length;i<len;i+=1){const cb=cbs[i];isFunction(cb)&&cb()}callbacks[type]=[]}})):"loaded"===s?init():"fail"===s?throwError("networkError",config):"loading"===s&&callbacks[type].push(init)})}}(window);